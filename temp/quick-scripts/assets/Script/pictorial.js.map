{"version":3,"sources":["pictorial.js"],"names":["cc","Class","extends","Component","properties","container","Node","avatar","prefab","Prefab","init","c","_controller","social","node","active","highLevel","getHighestLevel","showAvatar","loadContainer","level","data","gameData","json","levelData","heightScore","getHighestScore","getChildByName","getComponent","Label","string","name","setTimeout","scoreMgr","characterMgr","showCharacter","clearContainer","i","length","card","instantiate","parent","initCard","children","map","item","destroy","info","selfLevel","color","Color","WHITE","giftStep","BLACK"],"mappings":"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","file":"pictorial.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["/**\n * @author uu\n */\ncc.Class({\n  extends: cc.Component,\n  properties: {\n    container: cc.Node,\n    avatar: cc.Node,\n    prefab: cc.Prefab,\n  },\n  init(c) {\n    this._controller = c\n\n    if (c.social.node.active) {\n      let highLevel = c.social.getHighestLevel()\n      if (highLevel) {\n        this.showAvatar(highLevel)\n        this.loadContainer(+highLevel)\n      } else {\n        this.avatar.active = false\n        this.loadContainer(1)\n      }\n    } else {\n      this.avatar.active = false\n    }\n  },\n  showAvatar(level) {\n    this.avatar.active = true\n    let data = this._controller.gameData.json.levelData[+level - 1]\n    let heightScore = this._controller.social.getHighestScore()\n    this.avatar.getChildByName('name').getComponent(cc.Label).string = '历史最高:' + data.name\n    this.avatar.getChildByName('score').getComponent(cc.Label).string = '分数' + heightScore\n    setTimeout(() => {\n      this._controller.scoreMgr.characterMgr.showCharacter(+level, this.avatar.getChildByName('db'), false)\n    }, 1000)\n  },\n  loadContainer(level) {\n    let data = this._controller.gameData.json.levelData\n    this.clearContainer()\n    setTimeout(() => {\n      for (let i = 0; i < data.length; i++) {\n        let card = cc.instantiate(this.prefab)\n        card.parent = this.container\n        this.initCard(card, data[i], i, level)\n      }\n    }, 1000)\n  },\n  clearContainer() {\n    this.container.children.map(item => {\n      item.destroy()\n    })\n  },\n  initCard(card, info, level, selfLevel) {\n    if (level < selfLevel) {\n      card.getChildByName('name').getComponent(cc.Label).string = info.name\n      //card.getChildByName('score').getComponent(cc.Label).string = \"得分:\" + info.score\n      card.getChildByName('db').color = cc.Color.WHITE\n      card.getChildByName('giftStep').getComponent(cc.Label).string = \"开局奖励\" + info.giftStep + \"步\"\n    } else {\n      card.getChildByName('name').getComponent(cc.Label).string = '???'\n      card.getChildByName('giftStep').getComponent(cc.Label).string = \"开局奖励???步\"\n      card.getChildByName('db').color = cc.Color.BLACK\n    }\n    this._controller.scoreMgr.characterMgr.showCharacter(level + 1, card.getChildByName('db'), 0)\n  }\n});"]}