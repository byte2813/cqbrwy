{"version":3,"sources":["check.js"],"names":["cc","Class","extends","Component","properties","groups","map","mapLength","init","g","_game","rowNum","i","j","getComponent","isSingle","warningInit","check","propConfig","_controller","config","json","min","length","pushPop","target","x","iid","y","jid","color","z","max","warning","type","isPush","push","group","item","onWarning"],"mappings":"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","file":"check.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["/**\n * @author uu\n * @file 检测组件\n */\ncc.Class({\n  extends: cc.Component,\n  properties: {\n    groups: [],\n    map: [],\n    mapLength: 8\n  },\n  init(g) {\n    this._game = g\n    this.map = g.map\n    this.mapLength = g.rowNum\n    for (let i = 0; i < this.mapLength; i++) { //行\n      this.groups[i] = []\n      for (let j = 0; j < this.mapLength; j++) { //列\n        // this.map[i][j].getComponent('cell').growInit() //全部初始化\n        if (!this.map[i][j]) {\n          //    cc.log('报错x,y:', i, j)\n        }\n        this.map[i][j].getComponent('cell').isSingle = false\n        this.map[i][j].getComponent('cell').warningInit()\n        this.groups[i][j] = []\n      }\n    }\n  },\n  check(g) { //该函数主要用于检测一个区块能否形成道具等\n    let propConfig = g._controller.config.json.propConfig\n    this._game = g\n    this.map = g.map\n    this.mapLength = g.rowNum\n    let min = 999\n    for (let i = 0; i < propConfig.length; i++) {\n      min = propConfig[i].min < min ? propConfig[i].min : min\n    }\n    for (let i = 0; i < this.mapLength; i++) { //行\n      for (let j = 0; j < this.mapLength; j++) { //列\n        this.pushPop(this.map[i][j], i, j)\n        let target = this.map[i][j]\n        let x = target.getComponent('cell').iid\n        let y = target.getComponent('cell').jid\n        let isSingle = true\n        if ((x - 1) >= 0 && this.map[x - 1][y].getComponent('cell').color == target.getComponent('cell').color) {\n          isSingle = false\n        }\n        if ((x + 1) < this.mapLength && this.map[x + 1][y].getComponent('cell').color == target.getComponent('cell').color) {\n          isSingle = false\n        }\n\n        if ((y - 1) >= 0 && this.map[x][y - 1].getComponent('cell').color == target.getComponent('cell').color) {\n          isSingle = false\n        }\n        if ((y + 1) < this.mapLength && this.map[x][y + 1].getComponent('cell').color == target.getComponent('cell').color) {\n          isSingle = false\n        }\n        this.map[i][j].getComponent('cell').isSingle = isSingle\n       // console.log(i, j, this.map[i][j].getComponent('cell').isSingle, this.map[i][j].getComponent('cell').color)\n        if (this.groups[i][j].length >= min) {\n          for (let z = 0; z < propConfig.length; z++) {\n            if (this.groups[i][j].length <= propConfig[z].max && this.groups[i][j].length >= propConfig[z].min) {\n              this.warning(propConfig[z].type, this.groups[i][j])\n            }\n          }\n        }\n      }\n    }\n  },\n  pushPop(target, i, j) { //用于判断一个方块四个方向上的方块颜色是否一样 如果一样则加入组 如果组长度小于1则返回false?\n    // if (target.getComponent('cell').isPush==true) {\n    //   return\n    // }\n    target.getComponent('cell').isPush = true\n    this.groups[i][j].push(target)\n    let x = target.getComponent('cell').iid\n    let y = target.getComponent('cell').jid\n    if ((x - 1) >= 0) {\n      if (!this.map[x - 1][y].getComponent('cell').isPush && this.map[x - 1][y].getComponent('cell').color == target.getComponent('cell').color) {\n        this.pushPop(this.map[x - 1][y], i, j)\n      }\n    }\n    if ((x + 1) < this.mapLength) {\n      if (!this.map[x + 1][y].getComponent('cell').isPush && this.map[x + 1][y].getComponent('cell').color == target.getComponent('cell').color) {\n        this.pushPop(this.map[x + 1][y], i, j)\n      }\n    }\n    if ((y - 1) >= 0) {\n      if (!this.map[x][y - 1].getComponent('cell').isPush && this.map[x][y - 1].getComponent('cell').color == target.getComponent('cell').color) {\n        this.pushPop(this.map[x][y - 1], i, j)\n      }\n    }\n    if ((y + 1) < this.mapLength) {\n      if (!this.map[x][y + 1].getComponent('cell').isPush && this.map[x][y + 1].getComponent('cell').color == target.getComponent('cell').color) {\n        this.pushPop(this.map[x][y + 1], i, j)\n      }\n    }\n\n    // 判断方块是否单身\n\n  },\n  warning(type, group) {\n    group.map(item => {\n      item.getComponent('cell').onWarning(type)\n    })\n  }\n});"]}